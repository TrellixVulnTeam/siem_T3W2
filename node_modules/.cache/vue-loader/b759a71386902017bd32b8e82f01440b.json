{"remainingRequest":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\src\\components\\form\\TaskForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\src\\components\\form\\TaskForm.vue","mtime":1640353310867},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBWRm9ybUJ1aWxkZXIgfSBmcm9tICdAdG9va2l0L3ZtYScNCmltcG9ydCB7IFZUZXh0RmllbGQsIFZUZXh0YXJlYSwgVkF1dG9jb21wbGV0ZSB9IGZyb20gJ3Z1ZXRpZnkvbGliJw0KaW1wb3J0IFZFZGl0b3IgZnJvbSAnQC9jb21wb25lbnRzL2VkaXRvci9WRWRpdG9yJw0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgVkZvcm1CdWlsZGVyLA0KICB9LA0KICBwcm9wczogew0KICAgIGl0ZW06IE9iamVjdCwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICBmb3JtTW9kZWw6IHt9LA0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBnZXRQcm9qZWN0TGlzdCAoKSB7DQogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1sndGFzay9nZXRQcm9qZWN0TGlzdCddDQogICAgfSwNCiAgICBnZXRUYXNrU3RhdHVzICgpIHsNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0YXNrL2dldFRhc2tTdGF0dXMnXQ0KICAgIH0sDQogICAgZm9ybVRpdGxlKCkgew0KICAgICAgcmV0dXJuIHRoaXMuaXRlbSA/ICdFZGl0IFRhc2sgLSAnICsgdGhpcy5pdGVtLm5hbWUgOiAnQ3JlYXRlIFRhc2snDQogICAgfSwNCiAgICBmb3JtSXRlbXMoKSB7DQogICAgICByZXR1cm4gWw0KICAgICAgICB7DQogICAgICAgICAgY29sczogNiwNCiAgICAgICAgICBlbGVtZW50OiBWVGV4dEZpZWxkLA0KICAgICAgICAgIHByb3BzOiB7DQogICAgICAgICAgICBuYW1lOiAnbmFtZScsDQogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICAgIG91dGxpbmVkOiB0cnVlLA0KICAgICAgICAgICAgcnVsZXM6IFsodikgPT4gISF2IHx8ICdOYW1lIGlzIHJlcXVpcmVkJ10sDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNvbHM6IDYsDQogICAgICAgICAgZWxlbWVudDogVlRleHRGaWVsZCwNCiAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgbmFtZTogJ293bmVyJywNCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgICAgb3V0bGluZWQ6IHRydWUsDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNvbHM6IDYsDQogICAgICAgICAgZWxlbWVudDogVkF1dG9jb21wbGV0ZSwNCiAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgbmFtZTogJ3Byb2plY3RfaWQnLA0KICAgICAgICAgICAgbGFiZWw6ICdQcm9qZWN0JywNCiAgICAgICAgICAgIG91dGxpbmVkOiB0cnVlLA0KICAgICAgICAgICAgaXRlbXM6IHRoaXMuZ2V0UHJvamVjdExpc3QsDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNvbHM6IDYsDQogICAgICAgICAgZWxlbWVudDogVkF1dG9jb21wbGV0ZSwNCiAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgbGFiZWw6ICdTdGF0dXMnLA0KICAgICAgICAgICAgbmFtZTogJ3N0YXR1cycsDQogICAgICAgICAgICBvdXRsaW5lZDogdHJ1ZSwNCiAgICAgICAgICAgIGl0ZW1zOiB0aGlzLmdldFRhc2tTdGF0dXMsDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGNvbHM6IDEyLA0KICAgICAgICAgIGVsZW1lbnQ6IFZUZXh0YXJlYSwNCiAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgbmFtZTogJ2Rlc2NyaXB0aW9uJywNCiAgICAgICAgICAgIG91dGxpbmVkOiB0cnVlLA0KICAgICAgICAgIH0sDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjb2xzOiAxMiwNCiAgICAgICAgICBlbGVtZW50OiBWRWRpdG9yLA0KICAgICAgICAgIGRlZmF1bHQ6ICd0eXBlJywNCiAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgbmFtZTogJ2NvbnRlbnQnLA0KICAgICAgICAgICAgb3V0bGluZWQ6IHRydWUsDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgIF0NCiAgICB9LA0KICB9LA0KICB3YXRjaDogew0KICAgIGl0ZW06IHsNCiAgICAgIGhhbmRsZXIoaXRlbSkgew0KICAgICAgICB0aGlzLmZvcm1Nb2RlbCA9IGl0ZW0gPyB0aGlzLm1lcmdlRGF0YSh0aGlzLmZvcm1EYXRhKCksIGl0ZW0pIDogdGhpcy5mb3JtRGF0YSgpDQogICAgICB9LA0KICAgICAgaW1tZWRpYXRlOiB0cnVlLA0KICAgIH0sDQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3Rhc2svZmV0Y2hQcm9qZWN0JykNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIG1lcmdlRGF0YShzb3VyY2UsIHRhcmdldCkgew0KICAgICAgZm9yIChsZXQga2V5IGluIHNvdXJjZSkgew0KICAgICAgICBzb3VyY2Vba2V5XSA9IHRhcmdldFtrZXldDQogICAgICB9DQogICAgICByZXR1cm4gc291cmNlDQogICAgfSwNCiAgICBmb3JtRGF0YSgpIHsNCiAgICAgIGNvbnN0IG1vZGVsID0ge30NCiAgICAgIHRoaXMuZm9ybUl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHsNCiAgICAgICAgbW9kZWxbaXRlbS5wcm9wcy5uYW1lXSA9IGl0ZW0uZGVmYXVsdCB8fCBudWxsDQogICAgICB9KQ0KICAgICAgcmV0dXJuIG1vZGVsDQogICAgfSwNCiAgICBoYW5kbGVTdWJtaXQoKSB7DQogICAgICBjb25zdCBmb3JtID0gdGhpcy4kcmVmcy5idWlsZGVyLiRyZWZzLmZvcm0NCiAgICAgIGlmIChmb3JtLnZhbGlkYXRlKCkpIHsNCiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQ0KICAgICAgICBjb25zdCBkYXRhID0gdGhpcy50cmFuc2Zvcm1EYXRhKHRoaXMuZm9ybU1vZGVsKQ0KICAgICAgICBpZiAodGhpcy5pdGVtICYmIHRoaXMuaXRlbS5pZCkgew0KICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZQ0KICAgICAgICAgICAgLmRpc3BhdGNoKCd0YXNrL3VwZGF0ZVRhc2snLCB7DQogICAgICAgICAgICAgIGlkOiB0aGlzLml0ZW0uaWQsDQogICAgICAgICAgICAgIGRhdGE6IGRhdGEsDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdmb3JtOnN1Y2Nlc3MnKQ0KICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2Zvcm06ZmFpbCcpDQogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlDQogICAgICAgICAgICB9KQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZQ0KICAgICAgICAgICAgLmRpc3BhdGNoKCd0YXNrL2NyZWF0ZVRhc2snLCBkYXRhKQ0KICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdmb3JtOnN1Y2Nlc3MnKQ0KICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2Zvcm06ZmFpbCcpDQogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlDQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICB0cmFuc2Zvcm1EYXRhKGRhdGEpIHsNCiAgICAgIHJldHVybiBkYXRhDQogICAgfSwNCiAgfSwNCn0NCg=="},{"version":3,"sources":["TaskForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TaskForm.vue","sourceRoot":"src/components/form","sourcesContent":["<template>\r\n  <v-form-builder\r\n    ref=\"builder\"\r\n    v-model=\"formModel\"\r\n    :title=\"formTitle\"\r\n    :items=\"formItems\"\r\n    :loading=\"loading\"\r\n    color=\"primary\"\r\n    show-header\r\n    @form:submit=\"handleSubmit\"\r\n    @form:cancel=\"$emit('form:cancel')\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport { VFormBuilder } from '@tookit/vma'\r\nimport { VTextField, VTextarea, VAutocomplete } from 'vuetify/lib'\r\nimport VEditor from '@/components/editor/VEditor'\r\nexport default {\r\n  components: {\r\n    VFormBuilder,\r\n  },\r\n  props: {\r\n    item: Object,\r\n  },\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      formModel: {},\r\n    }\r\n  },\r\n  computed: {\r\n    getProjectList () {\r\n      return this.$store.getters['task/getProjectList']\r\n    },\r\n    getTaskStatus () {\r\n      return this.$store.getters['task/getTaskStatus']\r\n    },\r\n    formTitle() {\r\n      return this.item ? 'Edit Task - ' + this.item.name : 'Create Task'\r\n    },\r\n    formItems() {\r\n      return [\r\n        {\r\n          cols: 6,\r\n          element: VTextField,\r\n          props: {\r\n            name: 'name',\r\n            required: true,\r\n            outlined: true,\r\n            rules: [(v) => !!v || 'Name is required'],\r\n          },\r\n        },\r\n        {\r\n          cols: 6,\r\n          element: VTextField,\r\n          props: {\r\n            name: 'owner',\r\n            required: true,\r\n            outlined: true,\r\n          },\r\n        },\r\n        {\r\n          cols: 6,\r\n          element: VAutocomplete,\r\n          props: {\r\n            name: 'project_id',\r\n            label: 'Project',\r\n            outlined: true,\r\n            items: this.getProjectList,\r\n          },\r\n        },\r\n        {\r\n          cols: 6,\r\n          element: VAutocomplete,\r\n          props: {\r\n            label: 'Status',\r\n            name: 'status',\r\n            outlined: true,\r\n            items: this.getTaskStatus,\r\n          },\r\n        },\r\n        {\r\n          cols: 12,\r\n          element: VTextarea,\r\n          props: {\r\n            name: 'description',\r\n            outlined: true,\r\n          },\r\n        },\r\n        {\r\n          cols: 12,\r\n          element: VEditor,\r\n          default: 'type',\r\n          props: {\r\n            name: 'content',\r\n            outlined: true,\r\n          },\r\n        },\r\n      ]\r\n    },\r\n  },\r\n  watch: {\r\n    item: {\r\n      handler(item) {\r\n        this.formModel = item ? this.mergeData(this.formData(), item) : this.formData()\r\n      },\r\n      immediate: true,\r\n    },\r\n  },\r\n  created() {\r\n    this.$store.dispatch('task/fetchProject')\r\n  },\r\n  methods: {\r\n    mergeData(source, target) {\r\n      for (let key in source) {\r\n        source[key] = target[key]\r\n      }\r\n      return source\r\n    },\r\n    formData() {\r\n      const model = {}\r\n      this.formItems.forEach((item) => {\r\n        model[item.props.name] = item.default || null\r\n      })\r\n      return model\r\n    },\r\n    handleSubmit() {\r\n      const form = this.$refs.builder.$refs.form\r\n      if (form.validate()) {\r\n        this.loading = true\r\n        const data = this.transformData(this.formModel)\r\n        if (this.item && this.item.id) {\r\n          return this.$store\r\n            .dispatch('task/updateTask', {\r\n              id: this.item.id,\r\n              data: data,\r\n            })\r\n            .then(() => {\r\n              this.$emit('form:success')\r\n              this.loading = false\r\n            })\r\n            .catch(() => {\r\n              this.$emit('form:fail')\r\n              this.loading = false\r\n            })\r\n        } else {\r\n          return this.$store\r\n            .dispatch('task/createTask', data)\r\n            .then(() => {\r\n              this.$emit('form:success')\r\n              this.loading = false\r\n            })\r\n            .catch(() => {\r\n              this.$emit('form:fail')\r\n              this.loading = false\r\n            })\r\n        }\r\n      }\r\n    },\r\n    transformData(data) {\r\n      return data\r\n    },\r\n  },\r\n}\r\n</script>\r\n"]}]}