{"remainingRequest":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\src\\views\\task\\KanBoard.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\src\\views\\task\\KanBoard.vue","mtime":1640353310878},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQ0F2YXRhciBmcm9tICdAL2NvbXBvbmVudHMvYXZhdGFyL0NBdmF0YXInDQppbXBvcnQgVGFza0Zvcm0gZnJvbSAnQC9jb21wb25lbnRzL2Zvcm0vVGFza0Zvcm0nDQppbXBvcnQgU29ydGFibGUgZnJvbSAnc29ydGFibGVqcycNCmltcG9ydCBUb29sdGlwTWl4aW4gZnJvbSAnQC9taXhpbnMvVG9vbHRpcCcNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0thbkJvYXJkJywNCiAgY29tcG9uZW50czogew0KICAgIENBdmF0YXIsDQogICAgVGFza0Zvcm0sDQogIH0sDQogIG1peGluczogW1Rvb2x0aXBNaXhpbl0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHByb2plY3RfaWQ6IDEsDQogICAgICBzaG93RGlhbG9nOiBmYWxzZSwNCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgaXRlbXM6IFtdLA0KICAgICAgc2VsZWN0ZWRJdGVtOiBudWxsLA0KICAgICAgYWN0aW9uczogWw0KICAgICAgICB7DQogICAgICAgICAgdGV4dDogJ0VkaXQgSXRlbScsDQogICAgICAgICAgaWNvbjogJ21kaS1wZW5jaWwnLA0KICAgICAgICAgIGNsaWNrOiB0aGlzLmhhbmRsZUVkaXRJdGVtLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGV4dDogJ0RlbGV0ZSBJdGVtJywNCiAgICAgICAgICBpY29uOiAnbWRpLWNsb3NlJywNCiAgICAgICAgICBjbGljazogdGhpcy5oYW5kbGVEZWxldGVJdGVtLA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgZ2V0VGFza1N0YXR1cyAoKSB7DQogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1sndGFzay9nZXRUYXNrU3RhdHVzJ10NCiAgICB9LA0KICAgIGdldFByb2plY3RMaXN0ICgpIHsNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0YXNrL2dldFByb2plY3RMaXN0J10NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3Rhc2svZmV0Y2hQcm9qZWN0JykNCiAgICB0aGlzLmZldGNoVGFzaygpDQogICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgdGhpcy5nZXRUYXNrU3RhdHVzLmZvckVhY2goKGl0ZW0pID0+IHsNCiAgICAgICAgbmV3IFNvcnRhYmxlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCN0YXNrLWxpc3RfXyR7aXRlbS52YWx1ZX1gKSwgew0KICAgICAgICAgIGdyb3VwOiAnc2hhcmVkJywNCiAgICAgICAgICBhbmltYXRpb246IDE1MCwNCiAgICAgICAgICBvbkVuZDogKGUpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHRhc2tJZCA9IGUuaXRlbS5kYXRhc2V0LmlkDQogICAgICAgICAgICBjb25zdCBzdGF0dXMgPSBlLnRvLmRhdGFzZXQuc3RhdHVzDQogICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndGFzay91cGRhdGVUYXNrU3RhdHVzJywgeyBpZDogdGFza0lkLCBzdGF0dXM6IHN0YXR1cyB9KQ0KICAgICAgICAgIH0sDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0pDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBmZXRjaFRhc2soKSB7DQogICAgICB0aGlzLml0ZW1zID0gW10NCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUNCiAgICAgIGNvbnN0IHF1ZXJ5ID0gew0KICAgICAgICAnZmlsdGVyW3Byb2plY3RfaWRdJzogdGhpcy5wcm9qZWN0X2lkLA0KICAgICAgfQ0KICAgICAgdGhpcy4kc3RvcmUNCiAgICAgICAgLmRpc3BhdGNoKCd0YXNrL2ZldGNoVGFzaycsIHF1ZXJ5KQ0KICAgICAgICAudGhlbigocmVzcCkgPT4gew0KICAgICAgICAgIHRoaXMuaXRlbXMgPSByZXNwLmRhdGENCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKCkgPT4gew0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlDQogICAgICAgIH0pDQogICAgfSwNCiAgICBjb21wdXRlQXZhdGFyKHVzZXJuYW1lKSB7DQogICAgICBjb25zdCBhdmF0YXIgPSB0aGlzLmdldFVzZXJuYW1lID09PSB1c2VybmFtZSA/IHRoaXMuZ2V0QXZhdGFyIDogJycNCiAgICAgIHJldHVybiBhdmF0YXINCiAgICB9LA0KICAgIGhhbmRsZVByb2plY3RDaGFuZ2UoKSB7DQogICAgICB0aGlzLmZldGNoVGFzaygpDQogICAgfSwNCiAgICBnZXRUYXNrQnlTdGF0dXMoc3RhdHVzKSB7DQogICAgICByZXR1cm4gdGhpcy5pdGVtcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uc3RhdHVzID09PSBzdGF0dXMpDQogICAgfSwNCiAgICBoYW5kbGVDcmVhdGVUYXNrKCkgew0KICAgICAgdGhpcy5zZWxlY3RlZEl0ZW0gPSBudWxsDQogICAgICB0aGlzLnNob3dEaWFsb2cgPSB0cnVlDQogICAgfSwNCiAgICBoYW5kbGVFZGl0SXRlbShpdGVtKSB7DQogICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IGl0ZW0NCiAgICAgIHRoaXMuc2hvd0RpYWxvZyA9IHRydWUNCiAgICB9LA0KICAgIGhhbmRsZURlbGV0ZUl0ZW0oeyBpZCB9KSB7DQogICAgICBpZiAod2luZG93LmNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB0byBkZWxldGUgdGhpcycpKSB7DQogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd0YXNrL2RlbGV0ZVRhc2snLCBpZCkudGhlbigoKSA9PiB7DQogICAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmlkICE9IGlkKQ0KICAgICAgICB9KQ0KICAgICAgfQ0KICAgIH0sDQogICAgaGFuZGxlRm9ybVN1Y2Nlc3MoKSB7DQogICAgICB0aGlzLmZldGNoVGFzaygpDQogICAgICB0aGlzLnNob3dEaWFsb2cgPSBmYWxzZQ0KICAgIH0sDQogIH0sDQp9DQo="},{"version":3,"sources":["KanBoard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"KanBoard.vue","sourceRoot":"src/views/task","sourcesContent":["<template>\r\n  <div class=\"kanboard\">\r\n    <v-container>\r\n      <v-row>\r\n        <v-col :cols=\"12\">\r\n          <v-autocomplete\r\n            v-model=\"project_id\"\r\n            :items=\"getProjectList\"\r\n            label=\"Select Project\"\r\n            @change=\"handleProjectChange\"\r\n          >\r\n          </v-autocomplete>\r\n        </v-col>\r\n        <template v-for=\"col in getTaskStatus\">\r\n          <v-col :key=\"col.value\">\r\n            <v-card :loading=\"loading\">\r\n              <v-toolbar flat>\r\n                <v-toolbar-title>{{ col.text }} </v-toolbar-title>\r\n                <v-spacer />\r\n                <v-btn icon @click=\"handleCreateTask\">\r\n                  <v-icon>mdi-plus</v-icon>\r\n                </v-btn>\r\n              </v-toolbar>\r\n              <v-divider />\r\n              <v-card-text :id=\"'task-list__' + col.value\" class=\"task-list\" :data-status=\"col.value\">\r\n                <template v-for=\"task in getTaskByStatus(col.value)\">\r\n                  <div :key=\"task.id\" :data-id=\"task.id\" class=\"task-list__item\">\r\n                    <v-list-item :value=\"task\">\r\n                      <v-list-item-avatar>\r\n                        <v-icon v-if=\"!task.owner\">mdi-account-circle</v-icon>\r\n                        <c-avatar v-else :size=\"32\" :username=\"task.owner\" :src=\"computeAvatar(task.owner)\" />\r\n                      </v-list-item-avatar>\r\n                      <v-list-item-content>\r\n                        <v-list-item-title> #{{ task.id }} {{ task.name }}</v-list-item-title>\r\n                        <v-list-item-subtitle>{{ task.description }}</v-list-item-subtitle>\r\n                      </v-list-item-content>\r\n                      <v-list-item-action>\r\n                        <v-icon small @click.stop=\"handleEditItem(task)\">mdi-pencil</v-icon>\r\n                      </v-list-item-action>\r\n                    </v-list-item>\r\n                  </div>\r\n                </template>\r\n              </v-card-text>\r\n            </v-card>\r\n          </v-col>\r\n        </template>\r\n      </v-row>\r\n    </v-container>\r\n    <v-dialog v-model=\"showDialog\" scrollable width=\"840\">\r\n      <task-form :item=\"selectedItem\" @form:success=\"handleFormSuccess\" />\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CAvatar from '@/components/avatar/CAvatar'\r\nimport TaskForm from '@/components/form/TaskForm'\r\nimport Sortable from 'sortablejs'\r\nimport TooltipMixin from '@/mixins/Tooltip'\r\nexport default {\r\n  name: 'KanBoard',\r\n  components: {\r\n    CAvatar,\r\n    TaskForm,\r\n  },\r\n  mixins: [TooltipMixin],\r\n  data() {\r\n    return {\r\n      project_id: 1,\r\n      showDialog: false,\r\n      loading: false,\r\n      items: [],\r\n      selectedItem: null,\r\n      actions: [\r\n        {\r\n          text: 'Edit Item',\r\n          icon: 'mdi-pencil',\r\n          click: this.handleEditItem,\r\n        },\r\n        {\r\n          text: 'Delete Item',\r\n          icon: 'mdi-close',\r\n          click: this.handleDeleteItem,\r\n        },\r\n      ],\r\n    }\r\n  },\r\n  computed: {\r\n    getTaskStatus () {\r\n      return this.$store.getters['task/getTaskStatus']\r\n    },\r\n    getProjectList () {\r\n      return this.$store.getters['task/getProjectList']\r\n    }\r\n  },\r\n  created() {\r\n    this.$store.dispatch('task/fetchProject')\r\n    this.fetchTask()\r\n    this.$nextTick(() => {\r\n      this.getTaskStatus.forEach((item) => {\r\n        new Sortable(document.querySelector(`#task-list__${item.value}`), {\r\n          group: 'shared',\r\n          animation: 150,\r\n          onEnd: (e) => {\r\n            const taskId = e.item.dataset.id\r\n            const status = e.to.dataset.status\r\n            this.$store.dispatch('task/updateTaskStatus', { id: taskId, status: status })\r\n          },\r\n        })\r\n      })\r\n    })\r\n  },\r\n  methods: {\r\n    fetchTask() {\r\n      this.items = []\r\n      this.loading = true\r\n      const query = {\r\n        'filter[project_id]': this.project_id,\r\n      }\r\n      this.$store\r\n        .dispatch('task/fetchTask', query)\r\n        .then((resp) => {\r\n          this.items = resp.data\r\n          this.loading = false\r\n        })\r\n        .catch(() => {\r\n          this.loading = false\r\n        })\r\n    },\r\n    computeAvatar(username) {\r\n      const avatar = this.getUsername === username ? this.getAvatar : ''\r\n      return avatar\r\n    },\r\n    handleProjectChange() {\r\n      this.fetchTask()\r\n    },\r\n    getTaskByStatus(status) {\r\n      return this.items.filter((item) => item.status === status)\r\n    },\r\n    handleCreateTask() {\r\n      this.selectedItem = null\r\n      this.showDialog = true\r\n    },\r\n    handleEditItem(item) {\r\n      this.selectedItem = item\r\n      this.showDialog = true\r\n    },\r\n    handleDeleteItem({ id }) {\r\n      if (window.confirm('Are you sure to delete this')) {\r\n        this.$store.dispatch('task/deleteTask', id).then(() => {\r\n          this.items = this.items.filter((item) => item.id != id)\r\n        })\r\n      }\r\n    },\r\n    handleFormSuccess() {\r\n      this.fetchTask()\r\n      this.showDialog = false\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"sass\" scoped>\r\n.task-list\r\n  min-height: 500px\r\n  padding: 0\r\n  &__item\r\n    border-bottom: 1px solid #eee\r\n  .sortable-chosen,\r\n  .sortable-ghost\r\n    border: 1px dotted var(--v-primary-base)\r\n    background: #eee\r\n</style>\r\n"]}]}