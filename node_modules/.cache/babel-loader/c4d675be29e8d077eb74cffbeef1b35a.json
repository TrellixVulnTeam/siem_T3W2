{"remainingRequest":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\src\\store\\modules\\chat.js","dependencies":[{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\src\\store\\modules\\chat.js","mtime":1640353310872},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\babel.config.js","mtime":1640353093300},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\prj_scms\\branch_ducdm\\tkmsiem\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS5ub3cuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7Cgp2YXIgaW8gPSByZXF1aXJlKCdzb2NrZXQuaW8tY2xpZW50Jyk7Cgp2YXIgc3RhdGUgPSB7CiAgc29ja2V0OiBudWxsLAogIGNsaWVudElkOiBudWxsLAogIHNvY2tldENvbm5lY3RlZDogMCwKICBtZXNzYWdlczogW10sCiAgY2hhdFVzZXJzOiBbXSAvLyB7dXNlcm5hbWU6ICcnLCBzdGF0dXM6ICcnLCBjbGllbnRJZCwgJ2RldmljZSd9Cgp9OyAvLyBnZXR0ZXJzCgp2YXIgZ2V0dGVycyA9IHsKICBnZXRDbGllbnRJZDogZnVuY3Rpb24gZ2V0Q2xpZW50SWQoc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS5jbGllbnRJZDsKICB9LAogIGdldFNvY2tldDogZnVuY3Rpb24gZ2V0U29ja2V0KHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUuc29ja2V0OwogIH0sCiAgZ2V0TWVzc2FnZXM6IGZ1bmN0aW9uIGdldE1lc3NhZ2VzKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUubWVzc2FnZXM7CiAgfSwKICBnZXRDaGF0VXNlcnM6IGZ1bmN0aW9uIGdldENoYXRVc2VycyhzdGF0ZSkgewogICAgcmV0dXJuIHN0YXRlLmNoYXRVc2Vycy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgdmFyIGlwID0gaXRlbS5pcDsKICAgICAgaXRlbS5pcCA9IGlwID8gaXAucmVwbGFjZSgnOjpmZmZmOicsICcnKSA6ICcnOwogICAgICByZXR1cm4gaXRlbTsKICAgIH0pOwogIH0sCiAgZ2V0U3RhdHVzQnlOYW1lOiBmdW5jdGlvbiBnZXRTdGF0dXNCeU5hbWUoc3RhdGUpIHsKICAgIHJldHVybiBmdW5jdGlvbiAodXNlcm5hbWUpIHsKICAgICAgdmFyIHVzZXIgPSBzdGF0ZS5jaGF0VXNlcnMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnVzZXJuYW1lID09PSB1c2VybmFtZTsKICAgICAgfSk7CiAgICAgIHJldHVybiB1c2VyLnN0YXR1cyA/ICdvbmxpbmUnIDogJ29mZmxpbmUnOwogICAgfTsKICB9Cn07IC8vIGFjdGlvbnMKCnZhciBhY3Rpb25zID0gewogIGluaXRTb2NrZXQ6IGZ1bmN0aW9uIGluaXRTb2NrZXQoX3JlZikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0LAogICAgICAgIGRpc3BhdGNoID0gX3JlZi5kaXNwYXRjaCwKICAgICAgICByb290U3RhdGUgPSBfcmVmLnJvb3RTdGF0ZTsKICAgIHZhciBzb2NrZXQgPSBpby5jb25uZWN0KHByb2Nlc3MuZW52LlZVRV9BUFBfU09DS0VULCB7CiAgICAgIHJlY29ubmVjdGlvbkF0dGVtcHRzOiA1LAogICAgICB0cmFuc3BvcnRzOiBbJ3dlYnNvY2tldCddCiAgICB9KTsKICAgIHNvY2tldC5vbignY29ubmVjdCcsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHVzZXIgPSB7CiAgICAgICAgdXNlcm5hbWU6IHJvb3RTdGF0ZS5hdXRoLnVzZXJuYW1lCiAgICAgIH07CiAgICAgIGNvbW1pdCgnY2hhdC9TRVRfU09DS0VUJywgc29ja2V0LCB7CiAgICAgICAgcm9vdDogdHJ1ZQogICAgICB9KTsKICAgICAgZGlzcGF0Y2goJ2NoYXQvam9pblJvb20nLCB1c2VyLCB7CiAgICAgICAgcm9vdDogdHJ1ZQogICAgICB9KTsKICAgIH0pOwogICAgc29ja2V0Lm9uKCdqb2luJywgZnVuY3Rpb24gKHVzZXJzKSB7CiAgICAgIGRpc3BhdGNoKCdjaGF0L3B1c2hKb2luJywgdXNlcnMsIHsKICAgICAgICByb290OiB0cnVlCiAgICAgIH0pOwogICAgfSk7CiAgICBzb2NrZXQub24oJ21lc3NhZ2UnLCBmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgdmFyIHVzZXJuYW1lID0gX3JlZjIudXNlcm5hbWUsCiAgICAgICAgICB0ZXh0ID0gX3JlZjIudGV4dCwKICAgICAgICAgIGNyZWF0ZWRBdCA9IF9yZWYyLmNyZWF0ZWRBdDsKICAgICAgZGlzcGF0Y2goJ2NoYXQvcHVzaE1lc3NhZ2UnLCB7CiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgIHRleHQ6IHRleHQsCiAgICAgICAgY3JlYXRlZEF0OiBjcmVhdGVkQXQKICAgICAgfSwgewogICAgICAgIHJvb3Q6IHRydWUKICAgICAgfSk7CiAgICB9KTsKICAgIHNvY2tldC5vbignbGVhdmUnLCBmdW5jdGlvbiAoY2xpZW50SWQpIHsKICAgICAgZGlzcGF0Y2goJ2NoYXQvcHVzaExlYXZlJywgY2xpZW50SWQsIHsKICAgICAgICByb290OiB0cnVlCiAgICAgIH0pOwogICAgfSk7CiAgfSwKICBjbG9zZVNvY2tldDogZnVuY3Rpb24gY2xvc2VTb2NrZXQoX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKCiAgICBpZiAoc3RhdGUuc29ja2V0KSB7CiAgICAgIHN0YXRlLnNvY2tldC5jbG9zZSgpOwogICAgICBjb21taXQoJ2NoYXQvQ0xPU0VfQ09OTkVDVCcsICcnLCB7CiAgICAgICAgcm9vdDogdHJ1ZQogICAgICB9KTsKICAgIH0KICB9LAogIHB1c2hNZXNzYWdlOiBmdW5jdGlvbiBwdXNoTWVzc2FnZShfcmVmNCwgbWVzc2FnZSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdCwKICAgICAgICBkaXNwYXRjaCA9IF9yZWY0LmRpc3BhdGNoOwogICAgZGlzcGF0Y2goJ2FwcC91cGRhdGVOb3RpZmljYXRpb24nLCAiTmV3IE1lc3NzYWdlIGZyb20gIi5jb25jYXQobWVzc2FnZS51c2VybmFtZSwgIjogIikuY29uY2F0KG1lc3NhZ2UudGV4dCksIHsKICAgICAgcm9vdDogdHJ1ZQogICAgfSk7CiAgICBjb21taXQoJ2NoYXQvVVBEQVRFX01FU1NBR0VfTElTVCcsIG1lc3NhZ2UsIHsKICAgICAgcm9vdDogdHJ1ZQogICAgfSk7CiAgfSwKICBzZW5kTWVzc2FnZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UoX3JlZjUsIHRleHQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNS5jb21taXQsCiAgICAgICAgcm9vdFN0YXRlID0gX3JlZjUucm9vdFN0YXRlOwogICAgdmFyIG1lc3NhZ2UgPSB7CiAgICAgIHRleHQ6IHRleHQsCiAgICAgIHVzZXJuYW1lOiByb290U3RhdGUuYXV0aC51c2VybmFtZSwKICAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpCiAgICB9OwogICAgY29tbWl0KCdjaGF0L1NFTkRfTUVTU0FHRScsIG1lc3NhZ2UsIHsKICAgICAgcm9vdDogdHJ1ZQogICAgfSk7CiAgICBjb21taXQoJ2NoYXQvVVBEQVRFX01FU1NBR0VfTElTVCcsIG1lc3NhZ2UsIHsKICAgICAgcm9vdDogdHJ1ZQogICAgfSk7CiAgfSwKICBwdXNoSm9pbjogZnVuY3Rpb24gcHVzaEpvaW4oX3JlZjYsIHVzZXJzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjYuY29tbWl0OwogICAgdXNlcnMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiBpdGVtLnN0YXR1cyA9IDE7CiAgICB9KTsKICAgIGNvbW1pdCgnY2hhdC9VUERBVEVfVVNFUl9MSVNUJywgdXNlcnMsIHsKICAgICAgcm9vdDogdHJ1ZQogICAgfSk7CiAgfSwKICBwdXNoTGVhdmU6IGZ1bmN0aW9uIHB1c2hMZWF2ZShfcmVmNywgdXNlcikgewogICAgdmFyIGNvbW1pdCA9IF9yZWY3LmNvbW1pdDsKICAgIHVzZXIuc3RhdHVzID0gMDsKICAgIGNvbW1pdCgnY2hhdC9VUERBVEVfVVNFUl9MSVNUJywgW3VzZXJdLCB7CiAgICAgIHJvb3Q6IHRydWUKICAgIH0pOwogIH0sCiAgam9pblJvb206IGZ1bmN0aW9uIGpvaW5Sb29tKF9yZWY4LCB1c2VyKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjguY29tbWl0OwogICAgY29tbWl0KCdjaGF0L0pPSU5fUk9PTScsIHVzZXIsIHsKICAgICAgcm9vdDogdHJ1ZQogICAgfSk7CiAgfQp9OyAvLyBtdXRhdGlvbnMKCnZhciBtdXRhdGlvbnMgPSB7CiAgSU5JVF9VU0VSOiBmdW5jdGlvbiBJTklUX1VTRVIoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNoYXRVc2VycyA9IGRhdGEubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXNlcm5hbWU6IGl0ZW0udXNlcm5hbWUsCiAgICAgICAgc3RhdHVzOiAwCiAgICAgIH07CiAgICB9KTsKICB9LAogIFNFVF9TT0NLRVQ6IGZ1bmN0aW9uIFNFVF9TT0NLRVQoc3RhdGUsIHNvY2tldCkgewogICAgc3RhdGUuc29ja2V0ID0gc29ja2V0OwogICAgc3RhdGUuc29ja2V0Q29ubmVjdGVkID0gc29ja2V0LmNvbmVuY3RlZDsKICAgIHN0YXRlLmNsaWVudElkID0gc29ja2V0LmlkOwogIH0sCiAgQ0xPU0VfQ09OTkVDVDogZnVuY3Rpb24gQ0xPU0VfQ09OTkVDVChzdGF0ZSkgewogICAgc3RhdGUuc29ja2V0ID0gbnVsbDsKICAgIHN0YXRlLmNsaWVudElkID0gbnVsbDsKICB9LAogIEpPSU5fUk9PTTogZnVuY3Rpb24gSk9JTl9ST09NKHN0YXRlLCB1c2VyKSB7CiAgICBzdGF0ZS5zb2NrZXQuZW1pdCgnam9pbicsIHVzZXIpOwogIH0sCiAgVVBEQVRFX01FU1NBR0VfTElTVDogZnVuY3Rpb24gVVBEQVRFX01FU1NBR0VfTElTVChzdGF0ZSwgbWVzc2FnZSkgewogICAgc3RhdGUubWVzc2FnZXMucHVzaChtZXNzYWdlKTsKICB9LAogIFVQREFURV9VU0VSX0xJU1Q6IGZ1bmN0aW9uIFVQREFURV9VU0VSX0xJU1Qoc3RhdGUsIHVzZXJzKSB7CiAgICB1c2Vycy5mb3JFYWNoKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgIHZhciBpbmRleCA9IHN0YXRlLmNoYXRVc2Vycy5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS51c2VybmFtZSA9PT0gdXNlci51c2VybmFtZTsKICAgICAgfSk7CgogICAgICBpZiAoaW5kZXggPT09IC0xKSB7CiAgICAgICAgc3RhdGUuY2hhdFVzZXJzLnB1c2godXNlcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgVnVlLnNldChzdGF0ZS5jaGF0VXNlcnMsIGluZGV4LCB1c2VyKTsKICAgICAgfQogICAgfSk7CiAgfSwKICBTRU5EX01FU1NBR0U6IGZ1bmN0aW9uIFNFTkRfTUVTU0FHRShzdGF0ZSwgbWVzc2FnZSkgewogICAgc3RhdGUuc29ja2V0LmVtaXQoJ21lc3NhZ2UnLCBtZXNzYWdlKTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBnZXR0ZXJzOiBnZXR0ZXJzLAogIGFjdGlvbnM6IGFjdGlvbnMsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMKfTs="},{"version":3,"sources":["D:/project/prj_scms/branch_ducdm/tkmsiem/src/store/modules/chat.js"],"names":["Vue","io","require","state","socket","clientId","socketConnected","messages","chatUsers","getters","getClientId","getSocket","getMessages","getChatUsers","map","item","ip","replace","getStatusByName","username","user","find","status","actions","initSocket","commit","dispatch","rootState","connect","process","env","VUE_APP_SOCKET","reconnectionAttempts","transports","on","auth","root","users","text","createdAt","closeSocket","close","pushMessage","message","sendMessage","Date","now","pushJoin","pushLeave","joinRoom","mutations","INIT_USER","data","SET_SOCKET","conencted","id","CLOSE_CONNECT","JOIN_ROOM","emit","UPDATE_MESSAGE_LIST","push","UPDATE_USER_LIST","forEach","index","findIndex","set","SEND_MESSAGE","namespaced"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\n\r\nconst io = require('socket.io-client')\r\n\r\nconst state = {\r\n  socket: null,\r\n  clientId: null,\r\n  socketConnected: 0,\r\n  messages: [],\r\n  chatUsers: [], // {username: '', status: '', clientId, 'device'}\r\n}\r\n\r\n// getters\r\nconst getters = {\r\n  getClientId: (state) => state.clientId,\r\n  getSocket: (state) => state.socket,\r\n  getMessages: (state) => state.messages,\r\n  getChatUsers: (state) => {\r\n    return state.chatUsers.map((item) => {\r\n      let ip = item.ip\r\n      item.ip = ip ? ip.replace('::ffff:', '') : ''\r\n      return item\r\n    })\r\n  },\r\n  getStatusByName: (state) => (username) => {\r\n    const user = state.chatUsers.find((item) => item.username === username)\r\n    return user.status ? 'online' : 'offline'\r\n  },\r\n}\r\n\r\n// actions\r\nconst actions = {\r\n  initSocket({ commit, dispatch, rootState }) {\r\n    const socket = io.connect(process.env.VUE_APP_SOCKET, {\r\n      reconnectionAttempts: 5,\r\n      transports: ['websocket'],\r\n    })\r\n    socket.on('connect', () => {\r\n      const user = { username: rootState.auth.username }\r\n      commit('chat/SET_SOCKET', socket, { root: true })\r\n      dispatch('chat/joinRoom', user, {root: true})\r\n    })\r\n    socket.on('join', (users) => {\r\n      dispatch('chat/pushJoin', users, {root: true})\r\n    })\r\n    socket.on('message', ({ username, text, createdAt }) => {\r\n      dispatch('chat/pushMessage', { username, text, createdAt }, {root: true})\r\n    })\r\n    socket.on('leave', (clientId) => {\r\n      dispatch('chat/pushLeave', clientId, {root: true})\r\n    })\r\n  },\r\n  closeSocket({ commit, state }) {\r\n    if (state.socket) {\r\n      state.socket.close()\r\n      commit('chat/CLOSE_CONNECT', '', { root: true })\r\n    }\r\n  },\r\n  pushMessage({ commit, dispatch }, message) {\r\n    dispatch('app/updateNotification', `New Messsage from ${message.username}: ${message.text}`, {root: true})\r\n    commit('chat/UPDATE_MESSAGE_LIST', message, { root: true })\r\n  },\r\n  sendMessage({ commit, rootState }, text) {\r\n    const message = {\r\n      text: text,\r\n      username: rootState.auth.username,\r\n      createdAt: Date.now(),\r\n    }\r\n    commit('chat/SEND_MESSAGE', message, { root: true })\r\n    commit('chat/UPDATE_MESSAGE_LIST', message, { root: true })\r\n  },\r\n  pushJoin({ commit }, users) {\r\n    users.map((item) => (item.status = 1))\r\n    commit('chat/UPDATE_USER_LIST', users, { root: true })\r\n  },\r\n  pushLeave({ commit }, user) {\r\n    user.status = 0\r\n    commit('chat/UPDATE_USER_LIST', [user], { root: true })\r\n  },\r\n  joinRoom({ commit }, user) {\r\n    commit('chat/JOIN_ROOM', user, { root: true })\r\n  },\r\n}\r\n\r\n// mutations\r\nconst mutations = {\r\n  INIT_USER(state, data) {\r\n    state.chatUsers = data.map((item) => {\r\n      return {\r\n        username: item.username,\r\n        status: 0,\r\n      }\r\n    })\r\n  },\r\n  SET_SOCKET(state, socket) {\r\n    state.socket = socket\r\n    state.socketConnected = socket.conencted\r\n    state.clientId = socket.id\r\n  },\r\n  CLOSE_CONNECT(state) {\r\n    state.socket = null\r\n    state.clientId = null\r\n  },\r\n  JOIN_ROOM(state, user) {\r\n    state.socket.emit('join', user)\r\n  },\r\n  UPDATE_MESSAGE_LIST(state, message) {\r\n    state.messages.push(message)\r\n  },\r\n  UPDATE_USER_LIST(state, users) {\r\n    users.forEach((user) => {\r\n      const index = state.chatUsers.findIndex((item) => item.username === user.username)\r\n      if (index === -1) {\r\n        state.chatUsers.push(user)\r\n      } else {\r\n        Vue.set(state.chatUsers, index, user)\r\n      }\r\n    })\r\n  },\r\n  SEND_MESSAGE(state, message) {\r\n    state.socket.emit('message', message)\r\n  },\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  actions,\r\n  mutations,\r\n}\r\n"]}]}